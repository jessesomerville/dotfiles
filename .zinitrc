#!/usr/bin/env zsh

local zinitdir="$XDG_DATA_HOME/zinit"
if [[ ! -f "$zinitdir/zinit.git/zinit.zsh" ]]; then
  echoinfo "Installing zinit..."
  mkdir -pm 705 $zinitdir
  git clone https://github.com/zdharma-continuum/zinit "$zinitdir/zinit.git" \
    && echoinfo "Installation successful" \
    || echoerr "Installation failed" 
fi

source "$zinitdir/zinit.git/zinit.zsh"
autoload -Uz _zinit
(( ${+_comps} )) && _comps[zinit]=_zinit

zinit light-mode for \
  zdharma-continuum/zinit-annex-as-monitor \
  zdharma-continuum/zinit-annex-bin-gem-node \
  zdharma-continuum/zinit-annex-patch-dl \
  zdharma-continuum/zinit-annex-rust

typeset -U zle_highlight
zle_highlight=(paste:none $zle_highlight)  # don't highlight when pasting

zinit wait lucid light-mode for \
 atload"fast-theme clean > /dev/null" \
    zdharma-continuum/fast-syntax-highlighting \
 atload"!_zsh_autosuggest_start" \
    zsh-users/zsh-autosuggestions

zinit wait'!0' lucid as"command" from"gh-r" \
  atclone"./starship init zsh > init.zsh" atpull"%atclone" \
  src"init.zsh" for \
    starship/starship
